# 公考知识图谱使用文档

## 📚 概述

基于 Neo4j 图数据库构建的**公务员考试智能备考知识图谱系统**，采用层次化结构和"实体-关系-实体"三元组模型，帮助考生系统化学习、个性化推荐、智能分析薄弱项。

## 🏗️ 系统架构

### 层次化知识结构
```
科目 (Subject)
  ↓ HAS_MODULE
模块 (Module)
  ↓ HAS_CHAPTER
章节 (Chapter)
  ↓ HAS_TOPIC
主题 (Topic)
  ↓ HAS_KNOWLEDGE
知识点 (KnowledgePoint)
```

### 核心实体类型（10种）
1. **Subject** - 科目（行测、申论、公安专业科目）
2. **Module** - 模块（言语理解、数量关系、判断推理等）
3. **Chapter** - 章节（逻辑填空、片段阅读、数学运算等）
4. **Topic** - 主题/题型（实词辨析、成语辨析、工程问题等）
5. **KnowledgePoint** - 知识点（词义侧重分析、工程总量设特值等）
6. **Skill** - 解题技巧（语境分析法、特值法、排除法等）
7. **Question** - 历年真题（含题目、选项、答案、解析）
8. **Resource** - 学习资源（视频、文档、课件等）
## 🚀 快速开始

### 步骤 1: 启动 Neo4j 数据库
```powershell
.\start_neo4j.bat
```
等待启动完成，看到 "Started" 提示后，数据库已在 `bolt://localhost:7687` 运行。

### 步骤 2: 激活 Python 虚拟环境
```powershell
.\mapknowledge\Scripts\Activate.ps1
```
看到命令提示符前出现 `(mapknowledge)` 表示激活成功。

### 步骤 3: 初始化数据库 Schema
```powershell
python .\scripts\init_schema.py
```
创建 20 个约束和 65 个索引，耗时约 2-3 秒。

### 步骤 4: 导入示例数据
```powershell
python .\scripts\import_data.py .\data\exam_data.json
```
导入 46 个节点和 51 条关系，覆盖行测各模块的知识点。

### 步骤 5: 验证数据导入
```powershell
# 查看数据统计
python .\scripts\verify_data.py

# 查看知识树结构
python .\scripts\show_structure.py

# 运行查询示例
python .\scripts\exam_queries.py
```*TESTS** - 真题考察知识点
- **USES_SKILL** - 解答真题使用的技巧
- **BELONGS_TO_TOPIC** - 真题属于某个主题

**资源关系：**
- **HAS_RESOURCE** - 关联学习资源
- **DEFINES** - 概念定义关系
- **IS_TEST_POINT** - 知识点是考点

## 📊 核心查询示例

### 1. 查看科目知识结构
```cypher
// 查看行测科目的完整知识树
MATCH path = (s:Subject {name: '行测'})-[:HAS_MODULE*1..5]->(node)
RETURN path
LIMIT 50
```

### 2. 查询学习路径（前置知识）
```cypher
// 查询某个知识点的前置依赖
MATCH (k:KnowledgePoint {name: '语义轻重分析'})<-[:PREREQUISITE*]-(prereq)
RETURN prereq.name, prereq.difficulty
ORDER BY prereq.difficulty
```

### 3. 查询易混淆概念
```cypher
// 查找易混淆的知识点及区分要点
MATCH (k:KnowledgePoint {name: '词义侧重分析'})-[r:CONFUSABLE_WITH]-(confused)
RETURN confused.name, r.confusion_reason, r.distinction
```

### 4. 查询高频考点
```cypher
// 查找出现频率≥15次的知识点
## 💡 典型应用场景

### 场景 1：制定学习计划
**需求：** 学习"假言命题逆否规则"知识点  
**步骤：**
1. 查找前置知识点（基础概念）
2. 按难度排序生成学习路径
3. 查找相关学习资源

**Python 示例：**
```python
graph = ExamKnowledgeGraph(URI, USER, PASSWORD)
graph.query_2_learning_path("翻译推理")
graph.query_6_topic_resources("翻译推理")
## 📝 自定义数据导入

### JSON 数据格式
参考 `data/exam_data.json` 的格式：

```json
{
  "nodes": [
    {
      "label": "Subject",
      "properties": {
        "id": "SUB001",
        "name": "行测",
        "code": "XINGCE",
        "description": "行政职业能力测验"
      }
    },
    {
      "label": "KnowledgePoint",
      "properties": {
        "id": "KP001",
        "name": "词义侧重分析",
        "difficulty": 3,
        "importance": 4
      }
    }
## 🛠️ 高级功能

### 1. 使用 Python 脚本查询

所有查询功能已封装在 `scripts/exam_queries.py` 中：

```python
from scripts.exam_queries import ExamKnowledgeGraph

# 创建连接
graph = ExamKnowledgeGraph(
    uri="bolt://localhost:7687",
    user="neo4j",
    password="5211314zhg"
)

# 调用查询方法
graph.query_1_subject_structure("行测")
graph.query_2_learning_path("实词辨析")
graph.query_3_confusable_concepts("词义侧重分析")
graph.query_4_high_frequency_tests(15)
graph.query_5_skill_applications("语境分析法")
## 📁 工具脚本说明

| 脚本文件 | 功能说明 |
|---------|---------|
| `init_schema.py` | 初始化数据库约束和索引 |
| `import_data.py` | 从 JSON 导入数据（支持新旧格式） |
| `verify_data.py` | 验证数据导入情况，显示统计信息 |
| `show_structure.py` | 树形展示知识图谱层次结构 |
| `exam_queries.py` | 10个典型查询示例 |
| `clear_data.py` | 清空数据库（保留 Schema） |

## 📚 文档索引

- **schema.md** - 完整 Schema 设计文档
- **REBUILD_REPORT.md** - 知识图谱重建报告
- **QUICKSTART.md** - 5分钟快速开始
- **使用文档.md** - 本文档

## 🔧 常见问题

### Q1: 如何启动 Neo4j？
```powershell
.\start_neo4j.bat
```
或手动启动：
```powershell
.\neo4j-community-5.26.1\bin\neo4j.bat console
```

### Q2: 如何访问 Neo4j 浏览器？
在浏览器打开：`http://localhost:7474`  
首次登录使用：
- 用户名: `neo4j`
- 密码: `5211314zhg`

### Q3: 如何使用命令行查询？
```powershell
.\neo4j-community-5.26.1\bin\cypher-shell.bat -u neo4j -p 5211314zhg
```

### Q4: 如何清空所有数据？
```powershell
# 使用脚本（推荐，保留 Schema）
python .\scripts\clear_data.py

# 使用 Cypher（删除所有）
MATCH (n) DETACH DELETE n
```

### Q5: 数据导入失败怎么办？
检查：
1. Neo4j 是否正在运行
2. 虚拟环境是否激活
3. JSON 格式是否正确
4. 连接配置是否正确（URI/用户名/密码）

### Q6: 如何添加新的知识点？
```python
from neo4j import GraphDatabase

driver = GraphDatabase.driver("bolt://localhost:7687", 
                              auth=("neo4j", "5211314zhg"))
with driver.session() as session:
    session.run("""
        MERGE (k:KnowledgePoint {id: 'KP999'})
        SET k.name = '新知识点',
            k.difficulty = 3,
            k.importance = 4
    """)
driver.close()
```

### Q7: 如何备份数据？
```powershell
# 停止 Neo4j
.\neo4j-community-5.26.1\bin\neo4j.bat stop

# 复制 data 目录
Copy-Item -Path ".\neo4j-community-5.26.1\data" -Destination ".\backup\data_$(Get-Date -Format 'yyyyMMdd')" -Recurse
```

## 📊 数据统计

当前示例数据包含：
- **科目**: 3 个（行测、申论、公安专业科目）
- **模块**: 6 个（言语理解、数量关系、判断推理等）
- **章节**: 5 个
- **主题**: 9 个
- **知识点**: 10 个
- **真题**: 3 道
- **技巧**: 4 个
- **资源**: 2 个
- **总节点**: 46 个
- **总关系**: 51 条

## 🎯 下一步建议

1. **扩充数据** - 添加更多科目、模块、知识点
2. **真题库** - 导入近5年历年真题
3. **资源库** - 收集优质学习资源
4. **用户系统** - 添加学习记录和错题本功能
5. **可视化** - 开发 Web 界面展示知识图谱

---

**版本**: v2.0  
**更新日期**: 2026-01-04  
**Neo4j 版本**: Community 5.26.1  
**Python 版本**: 3.13.6
// 知识点重要性分析（被多少知识点依赖）
MATCH (k:KnowledgePoint)
OPTIONAL MATCH (k)<-[:PREREQUISITE]-(dependent)
RETURN k.name, count(dependent) as dependency_count
ORDER BY dependency_count DESC

// 查找某个模块的核心知识点
MATCH (m:Module {name: '言语理解与表达'})-[:HAS_CHAPTER*1..3]->(k:KnowledgePoint)
WHERE k.importance >= 4 AND k.frequency >= 15
RETURN k.name, k.importance, k.frequency
ORDER BY k.importance DESC, k.frequency DESC
```

### 3. 性能优化建议

- ✅ **索引已配置** - 20个约束 + 65个索引自动优化查询
- 使用 `LIMIT` 限制结果数量
- 使用参数化查询避免注入
- 批量操作使用 `UNWIND`
- 使用 `PROFILE` 分析查询性能：
  ```cypher
  PROFILE MATCH (s:Subject)-[:HAS_MODULE]->(m:Module)
  RETURN s, m
  ```
2. 获取混淆原因和区分要点
3. 对比学习强化记忆

**Python 示例：**
```python
graph.query_3_confusable_concepts("词义侧重分析")
```

### 场景 3：真题考点分析
**需求：** 分析2023年国考真题分布  
**步骤：**
1. 统计各知识点出现频率
2. 识别高频考点和趋势
3. 预测下次考试重点

**Python 示例：**
```python
graph.query_7_real_questions(2023, "国考")
graph.query_4_high_frequency_tests(15)
```

### 场景 4：技巧学习
**需求：** 掌握"特值法"解题技巧  
**步骤：**
1. 查询技巧说明和步骤
2. 查找适用题型
3. 练习相关真题

**Python 示例：**
```python
graph.query_5_skill_applications("特值法")
```

### 场景 5：模块学习统计
**需求：** 了解"言语理解"模块难度  
**步骤：**
1. 统计模块包含的章节和主题数
2. 计算平均难度和重要度
3. 规划学习时间

**Python 示例：**
```python
graph.query_9_module_statistics("言语理解与表达")
``` DESC
```

### 6. 查询学习资源
```cypher
// 查询某个主题的推荐学习资源
MATCH (t:Topic {name: '实词辨析'})-[r:HAS_RESOURCE]->(res:Resource)
WHERE r.recommended = true
RETURN res.title, res.type, res.author, res.quality
ORDER BY res.quality DESC
```

### 7. 查询真题分析
```cypher
// 查询2023年国考真题及考点分布
MATCH (q:Question {year: 2023, exam_type: '国考'})-[:TESTS]->(k:KnowledgePoint)
RETURN q.question_number, q.content, k.name
ORDER BY q.question_number
```

### 8. 查询完整学习链
```cypher
// 从科目到知识点的完整路径
MATCH (s:Subject {name: '行测'})-[:HAS_MODULE]->(m:Module)
      -[:HAS_CHAPTER]->(c:Chapter)-[:HAS_TOPIC]->(t:Topic {name: '实词辨析'})
OPTIONAL MATCH (t)-[:HAS_KNOWLEDGE]->(k:KnowledgePoint)
OPTIONAL MATCH (sk:Skill)-[:APPLIES_TO]->(t)
RETURN s.name, m.name, c.name, t.name, 
       collect(k.name) as knowledge_points,
       collect(sk.name) as skills
```
### 2. 易混淆知识点
```cypher
MATCH (k1)-[r:CONFUSABLE_WITH]-(k2)
WHERE r.confusion_rate > 50
RETURN k1.name, k2.name, r.key_difference
```

### 3. 题型高频知识点
```cypher
MATCH (kp)-[r:FREQUENTLY_TESTED_IN]->(qt:QuestionType {name: '逻辑判断'})
RETURN kp.name, r.frequency
ORDER BY r.frequency DESC
```

### 4. 真题分析
```cypher
MATCH (rq:RealQuestion {id: 'rq2023001'})<-[:APPEARS_IN]-(kp)
RETURN rq.title, collect(kp.name) as knowledge_points
```

## 💡 典型应用场景

### 场景 1：制定学习计划
查找"假言命题"的前置知识 → 按难度排序 → 生成学习路径

### 场景 2：针对性复习
识别易混淆概念对 → 对比学习 → 强化记忆

### 场景 3：真题研究
分析真题考点 → 掌握出题规律 → 预测高频考点

### 场景 4：个性化推荐
用户错题分析 → 识别薄弱项 → 推荐针对性资源

## 📝 自定义数据

创建 JSON 文件按照 `data/exam_data.json` 格式，然后：
```powershell
python .\scripts\import_data.py .\data\your_data.json
```

## 🛠️ 高级功能

### 图算法
```cypher
// 最短路径
MATCH path = shortestPath((a)-[*]-(b))
WHERE a.name = 'A' AND b.name = 'B'
RETURN path

// 中心性分析
MATCH (kp:KnowledgePoint)
RETURN kp.name, 
       size((kp)-[:PREREQUISITE]->()) as importance
ORDER BY importance DESC
```

### 性能优化
- 使用参数化查询
- 添加索引（已配置）
- 限制返回结果（LIMIT）
- 使用 PROFILE 分析

## 📚 文档索引

- **schema.md** - 完整 Schema 设计
- **QUICKSTART.md** - 快速开始指南
- **README_Neo4j_Setup.md** - Neo4j 安装

## 🔧 常见问题

**Q: 浏览器界面出错？**
使用命令行工具：`.\neo4j-community-5.26.1\bin\cypher-shell.bat`

**Q: 如何清空数据？**
```cypher
MATCH (n) DETACH DELETE n
```

**Q: 如何导出数据？**
使用 `neo4j-admin export` 或 APOC 插件

---
详细说明见完整文档，示例数据已就绪，可直接运行体验！
